<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:Winsane.UI.ViewModels"
             xmlns:views="using:Winsane.UI.Views"
             xmlns:ui="using:FluentAvalonia.UI.Controls"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="Winsane.UI.Views.SettingsView"
             x:DataType="vm:SettingsViewModel">
    
    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                  VerticalScrollBarVisibility="Auto">
        <StackPanel Spacing="8" MaxWidth="800" Margin="24">
            <!-- Header -->
            <TextBlock Text="Settings"
                       Theme="{StaticResource TitleTextBlockStyle}"
                       Margin="0,0,0,16"/>
            
            <!-- Backup Section -->
            <ui:SettingsExpander Header="System Backup"
                                 Description="Manage restore points and safety"
                                 IsExpanded="True">
                <ui:SettingsExpander.IconSource>
                <ui:SymbolIconSource Symbol="Save"/>
                </ui:SettingsExpander.IconSource>
                
                <ui:SettingsExpanderItem Content="Create Restore Point"
                                         Description="Create a Windows System Restore Point">
                    <ui:SettingsExpanderItem.Footer>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                             <TextBlock Text="{Binding BackupStatusText}"
                                        VerticalAlignment="Center"
                                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"/>
                             <Button Content="Create Backup"
                                     Command="{Binding CreateBackupCommand}"
                                     IsEnabled="{Binding !IsBackingUp}"/>
                        </StackPanel>
                    </ui:SettingsExpanderItem.Footer>
                </ui:SettingsExpanderItem>
            </ui:SettingsExpander>

            <!-- Appearance Section -->
            <ui:SettingsExpander Header="Appearance"
                                 Description="Customize how Winsane looks"
                                 IsExpanded="True">
                <ui:SettingsExpander.IconSource>
                <ui:SymbolIconSource Symbol="DarkTheme"/>
                </ui:SettingsExpander.IconSource>
                
                <!-- Theme Selection -->
                <ui:SettingsExpanderItem Content="Theme"
                                         Description="Choose between light, dark, or system theme">
                    <ui:SettingsExpanderItem.Footer>
                        <ComboBox SelectedIndex="{Binding SelectedThemeIndex}"
                                  Width="150">
                            <ComboBoxItem Content="System"/>
                            <ComboBoxItem Content="Light"/>
                            <ComboBoxItem Content="Dark"/>
                        </ComboBox>
                    </ui:SettingsExpanderItem.Footer>
                </ui:SettingsExpanderItem>
                
                <!-- Accent Color -->
                <ui:SettingsExpanderItem Content="Accent Color"
                                         Description="Choose your accent color">
                    <ui:SettingsExpanderItem.Footer>
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <Border Background="{Binding AccentColor, Converter={x:Static views:SettingsView.ColorToBrushConverter}}"
                                    Width="32" Height="32"
                                    CornerRadius="4"/>
                            <TextBox Text="{Binding AccentColorHex}"
                                     Width="100"
                                     VerticalAlignment="Center"/>
                        </StackPanel>
                    </ui:SettingsExpanderItem.Footer>
                </ui:SettingsExpanderItem>
            </ui:SettingsExpander>
            
            <!-- Color Palette -->
            <ui:SettingsExpander Header="Color Palette"
                                 Description="Quick color selection"
                                 IsExpanded="True">
                <ui:SettingsExpander.IconSource>
                <ui:SymbolIconSource Symbol="Highlight"/>
                </ui:SettingsExpander.IconSource>
                
                <ui:SettingsExpanderItem>
                    <WrapPanel x:Name="ColorPalette" 
                               Orientation="Horizontal"
                               Margin="0,8"/>
                </ui:SettingsExpanderItem>
            </ui:SettingsExpander>
            
            <!-- About Section -->
            <ui:SettingsExpander Header="About"
                                 Description="Application information"
                                 IsExpanded="True">
                <ui:SettingsExpander.IconSource>
                <ui:SymbolIconSource Symbol="Help"/>
                </ui:SettingsExpander.IconSource>
                
                <ui:SettingsExpanderItem Content="Winsane"
                                         Description="Windows 11 Optimizer"/>
                <ui:SettingsExpanderItem Content="Version"
                                         Description="1.0.0"/>
                <ui:SettingsExpanderItem Content="Framework"
                                         Description="Avalonia UI with FluentAvalonia"/>
                
                <ui:SettingsExpanderItem Content="GitHub Repository"
                                         Description="https://github.com/wirekurosastak/Winsane"
                                         ActionIconSource="Link">
                    <ui:SettingsExpanderItem.Footer>
                        <Button Content="Open in Browser"
                                Command="{Binding OpenUrlCommand}"
                                CommandParameter="https://github.com/wirekurosastak/Winsane"/>
                    </ui:SettingsExpanderItem.Footer>
                </ui:SettingsExpanderItem>
            </ui:SettingsExpander>
        </StackPanel>
    </ScrollViewer>
</UserControl>
